<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Bolão Mega-Sena</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 980px;
      margin: 20px auto;
      padding: 12px;
    }
    h1 { text-align: center; margin-bottom: 8px; }

    .hint {
      text-align: center;
      color: #444;
      margin-bottom: 18px;
      font-size: 14px;
    }

    .field { margin-bottom: 16px; }
    label { font-weight: 600; }

    input[type="text"] {
      width: 100%;
      max-width: 360px;
      padding: 10px;
      border-radius: 8px;
      border: 1px solid #bbb;
      margin-top: 6px;
    }

    .game {
      border: 1px solid #ddd;
      padding: 12px;
      margin-bottom: 14px;
      border-radius: 10px;
      background: #fff;
    }
    .game-title {
      font-weight: 700;
      margin-bottom: 8px;
      display: flex;
      align-items: baseline;
      justify-content: space-between;
      gap: 10px;
    }
    .counter {
      font-size: 12px;
      color: #666;
      font-weight: 600;
    }
    .numbers {
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
    }
    .number-btn {
      width: 38px;
      height: 34px;
      border: 1px solid #aaa;
      border-radius: 10px;
      cursor: pointer;
      font-size: 14px;
      background: #f5f5f5;
    }
    .number-btn.selected {
      background: #2e7d32;
      color: #fff;
      border-color: #1b5e20;
      font-weight: 700;
    }

    .actions {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-top: 12px;
      flex-wrap: wrap;
    }

    button#sendBtn {
      padding: 12px 18px;
      font-size: 16px;
      border-radius: 10px;
      border: 1px solid #aaa;

      background-color: #ffffff;   /* explícito */
      color: #000000;              /* garante texto no mobile */

      cursor: pointer;

      -webkit-appearance: none;    /* iOS Safari */
      appearance: none;
    }

    button.secondary {
      padding: 12px 18px;
      font-size: 14px;
      border-radius: 10px;
      border: 1px solid #ddd;
      background: #fafafa;
      cursor: pointer;
    }

    #status {
      margin-top: 14px;
      padding: 12px;
      border-radius: 10px;
      border: 1px solid #ddd;
      background: #fafafa;
      white-space: pre-line;
    }
    .ok { border-color: #c8e6c9; background: #e8f5e9; }
    .err { border-color: #ffcdd2; background: #ffebee; }
  </style>
</head>
<body>

  <h1>Bolão Mega-Sena</h1>
  <div class="hint">Preencha 3 jogos de 6 números (1 a 60).</div>

  <!-- Netlify Forms -->
  <form
    name="bolao-megasena"
    method="POST"
    data-netlify="true"
    netlify-honeypot="bot-field"
    action="/obrigado.html"
  >
    <input type="hidden" name="form-name" value="bolao-megasena" />

    <!-- Honeypot (anti-spam). Deixe oculto. -->
    <p style="display:none;">
      <label>Não preencha: <input name="bot-field" /></label>
    </p>

    <div class="field">
      <label for="nome">Seu nome</label><br />
      <input type="text" id="nome" name="nome" placeholder="Ex: Seu Nome" required />
    </div>

    <div id="games"></div>

    <!-- Campos gravados pelo Netlify -->
    <input type="hidden" name="jogo1" id="jogo1" />
    <input type="hidden" name="jogo2" id="jogo2" />
    <input type="hidden" name="jogo3" id="jogo3" />
    <textarea name="resumo" id="resumo" style="display:none;"></textarea>

    <div class="actions">
      <button id="sendBtn" type="submit">Enviar</button>
      <button class="secondary" type="button" id="clearBtn">Limpar</button>
    </div>

    <div id="status">Status: pronto para enviar.</div>
  </form>

  <script>
    const gamesConfig = [
      { id: "g1", label: "Jogo 1", max: 6 },
      { id: "g2", label: "Jogo 2", max: 6 },
      { id: "g3", label: "Jogo 3", max: 6 },
    ];

    const state = {
      g1: new Set(),
      g2: new Set(),
      g3: new Set(),
    };

    const gamesEl = document.getElementById("games");
    const statusEl = document.getElementById("status");
    const formEl = document.querySelector('form[name="bolao-megasena"]');

    function renderGames() {
      gamesEl.innerHTML = "";

      for (const g of gamesConfig) {
        const wrap = document.createElement("div");
        wrap.className = "game";

        const title = document.createElement("div");
        title.className = "game-title";

        const left = document.createElement("div");
        left.textContent = `${g.label} (${g.max} números)`;

        const right = document.createElement("div");
        right.className = "counter";
        right.id = `counter-${g.id}`;
        right.textContent = `Selecionados: 0/${g.max}`;

        title.appendChild(left);
        title.appendChild(right);

        const numbers = document.createElement("div");
        numbers.className = "numbers";

        for (let n = 1; n <= 60; n++) {
          const btn = document.createElement("button");
          btn.type = "button";
          btn.className = "number-btn";
          btn.textContent = n;

          btn.addEventListener("click", () => toggle(g.id, n, btn, g.max));
          numbers.appendChild(btn);
        }

        wrap.appendChild(title);
        wrap.appendChild(numbers);
        gamesEl.appendChild(wrap);
      }
    }

    function updateCounter(gameId, max) {
      const c = document.getElementById(`counter-${gameId}`);
      if (!c) return;
      c.textContent = `Selecionados: ${state[gameId].size}/${max}`;
    }

    function toggle(gameId, n, btn, max) {
      const set = state[gameId];
      if (set.has(n)) {
        set.delete(n);
        btn.classList.remove("selected");
      } else {
        if (set.size >= max) {
          alert(`Este jogo aceita no máximo ${max} números.`);
          return;
        }
        set.add(n);
        btn.classList.add("selected");
      }
      updateCounter(gameId, max);
    }

    function getSortedArray(set) {
      return Array.from(set).sort((a,b) => a - b);
    }

    function validateAll() {
      for (const g of gamesConfig) {
        if (state[g.id].size !== g.max) {
          return `${g.label} deve ter exatamente ${g.max} números.`;
        }
      }
      return null;
    }

    function fillNetlifyFields() {
      const nome = (document.getElementById("nome").value || "").trim();

      const j1 = getSortedArray(state.g1);
      const j2 = getSortedArray(state.g2);
      const j3 = getSortedArray(state.g3);

      document.getElementById("jogo1").value = j1.join(",");
      document.getElementById("jogo2").value = j2.join(",");
      document.getElementById("jogo3").value = j3.join(",");

      const resumo =
`Participante: ${nome}
Jogo 1: ${j1.join(", ")}
Jogo 2: ${j2.join(", ")}
Jogo 3: ${j3.join(", ")}`;

      document.getElementById("resumo").value = resumo;

      statusEl.className = "ok";
      statusEl.textContent = "Tudo certo ✅ Enviando...";
    }

    formEl.addEventListener("submit", (e) => {
      statusEl.className = "";
      statusEl.textContent = "Validando...";

      const err = validateAll();
      if (err) {
        e.preventDefault();
        statusEl.className = "err";
        statusEl.textContent = "Erro: " + err;
        return;
      }

      fillNetlifyFields();
      // deixa enviar normalmente
    });

    document.getElementById("clearBtn").addEventListener("click", () => {
      document.getElementById("nome").value = "";
      for (const g of gamesConfig) state[g.id].clear();
      renderGames();
      statusEl.className = "";
      statusEl.textContent = "Status: pronto para enviar.";
    });

    renderGames();
  </script>
</body>
</html>
